Create a protected Next.js route with authentication enforcement.

Generate:
- Protected page component with authentication check
- Middleware for route protection (middleware.ts pattern)
- Authentication state verification (server-side)
- Redirect logic to login page with return URL
- Loading state while checking authentication
- Unauthorized access handling
- TypeScript types for protected route props
- Higher-order component or wrapper for route protection
- API route protection with authentication middleware
- Role-based access control (RBAC) if needed

Implement both page-level protection (Server Components) and API route protection. Include proper error handling, loading states, and redirect logic. Ensure protected routes work with SSR and Client Components.
